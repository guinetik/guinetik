const x={};function P(e){x.context=e}const fe=(e,t)=>e===t,ae=Symbol("solid-track"),G={equals:fe};let ne=ie;const R={},I=1,K=2,re={owned:null,cleanups:null,context:null,owner:null};var a=null;let M=null,f=null,D=null,w=null,A=null,Y=0;function $(e,t){const r=f,n=a,s=e.length===0,l=s?re:{owned:null,cleanups:null,context:null,owner:t||n},o=s?e:()=>e(()=>ee(l));a=l,f=null;try{return _(o,!0)}finally{f=r,a=n}}function j(e,t){t=t?Object.assign({},G,t):G;const r={value:e,observers:null,observerSlots:null,pending:R,comparator:t.equals||void 0},n=s=>(typeof s=="function"&&(s=s(r.pending!==R?r.pending:r.value)),Z(r,s));return[ue.bind(r),n]}function W(e,t,r){const n=B(e,t,!0,I);q(n)}function Fe(e,t,r){const n=B(e,t,!1,I);q(n)}function de(e,t,r){ne=ye;const n=B(e,t,!1,I),s=V&&Q(a,V.id);s&&(n.suspense=s),n.user=!0,A?A.push(n):q(n)}function N(e,t,r){r=r?Object.assign({},G,r):G;const n=B(e,t,!0,0);return n.pending=R,n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,q(n),ue.bind(n)}function pe(e,t,r){arguments.length===2?typeof t=="object"&&(r=t,t=e,e=!0):arguments.length===1&&(t=e,e=!0),r||(r={});const n=new Set,[s,l]=j(r.initialValue),[o,i]=j(void 0,{equals:!1}),[d,p]=j(!1),[u,E]=j();let c,g=null,b=null,m=!1,F="initialValue"in r,S=typeof e=="function"&&N(e);x.context&&(`${x.context.id}`,x.context.count++);function h(v,C,L,U){return g===v&&(g=null,F=!0,b&&(v===b||C===b)&&r.onHydrated&&queueMicrotask(()=>r.onHydrated(U,{value:C})),b=null,E(c=L),y(C)),C}function y(v){J(()=>{l(()=>v),p(!1);for(const C of n.keys())C.decrement();n.clear()})}function k(){const v=V&&Q(a,V.id),C=s();if(c)throw c;return f&&!f.user&&v&&W(()=>{o(),g&&(v.resolved&&M?M.promises.add(g):n.has(v)||(v.increment(),n.add(v)))}),C}function T(v=!0){if(v&&m)return;m=!1,E(c=void 0);const C=S?S():e;if(C==null||C===!1){h(g,O(s));return}const L=b||O(()=>t(C,{value:s(),refetching:v}));return typeof L!="object"||!("then"in L)?(h(g,L),L):(g=L,m=!0,queueMicrotask(()=>m=!1),J(()=>{p(!0),i()}),L.then(U=>h(L,U,void 0,C),U=>h(L,U,U)))}return Object.defineProperties(k,{loading:{get(){return d()}},error:{get(){return u()}},latest:{get(){if(!F)return k();if(c)throw c;return s()}}}),S?W(()=>T(!1)):T(!1),[k,{refetch:T,mutate:l}]}function J(e){if(D)return e();let t;const r=D=[];try{t=e()}finally{D=null}return _(()=>{for(let n=0;n<r.length;n+=1){const s=r[n];if(s.pending!==R){const l=s.pending;s.pending=R,Z(s,l)}}},!1),t}function O(e){let t,r=f;return f=null,t=e(),f=r,t}function Te(e){de(()=>O(e))}function se(e){return a===null||(a.cleanups===null?a.cleanups=[e]:a.cleanups.push(e)),e}function he(){return a}function ge(e){A.push.apply(A,e),e.length=0}function le(e){const t=Symbol("context");return{id:t,Provider:Se(t),defaultValue:e}}function be(e){let t;return(t=Q(a,e.id))!==void 0?t:e.defaultValue}function we(e){const t=N(e);return N(()=>X(t()))}let V;function me(){return V||(V=le({}))}function ue(){const e=M;if(this.sources&&(this.state||e)){const t=w;w=null,this.state===I||e?q(this):z(this),w=t}if(f){const t=this.observers?this.observers.length:0;f.sources?(f.sources.push(this),f.sourceSlots.push(t)):(f.sources=[this],f.sourceSlots=[t]),this.observers?(this.observers.push(f),this.observerSlots.push(f.sources.length-1)):(this.observers=[f],this.observerSlots=[f.sources.length-1])}return this.value}function Z(e,t,r){if(D)return e.pending===R&&D.push(e),e.pending=t,t;if(e.comparator&&e.comparator(e.value,t))return t;let n=!1;return e.value=t,e.observers&&e.observers.length&&_(()=>{for(let s=0;s<e.observers.length;s+=1){const l=e.observers[s];n&&M.disposed.has(l),(n&&!l.tState||!n&&!l.state)&&(l.pure?w.push(l):A.push(l),l.observers&&oe(l)),n||(l.state=I)}if(w.length>1e6)throw w=[],new Error},!1),t}function q(e){if(!e.fn)return;ee(e);const t=a,r=f,n=Y;f=a=e,ve(e,e.value,n),f=r,a=t}function ve(e,t,r){let n;try{n=e.fn(t)}catch(s){ce(s)}(!e.updatedAt||e.updatedAt<=r)&&(e.observers&&e.observers.length?Z(e,n):e.value=n,e.updatedAt=r)}function B(e,t,r,n=I,s){const l={fn:e,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:a,context:null,pure:r};return a===null||a!==re&&(a.owned?a.owned.push(l):a.owned=[l]),l}function H(e){const t=M;if(e.state===0||t)return;if(e.state===K||t)return z(e);if(e.suspense&&O(e.suspense.inFallback))return e.suspense.effects.push(e);const r=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<Y);)(e.state||t)&&r.push(e);for(let n=r.length-1;n>=0;n--)if(e=r[n],e.state===I||t)q(e);else if(e.state===K||t){const s=w;w=null,z(e,r[0]),w=s}}function _(e,t){if(w)return e();let r=!1;t||(w=[]),A?r=!0:A=[],Y++;try{const n=e();return xe(r),n}catch(n){ce(n)}finally{w=null,r||(A=null)}}function xe(e){w&&(ie(w),w=null),!e&&(A.length?J(()=>{ne(A),A=null}):A=null)}function ie(e){for(let t=0;t<e.length;t++)H(e[t])}function ye(e){let t,r=0;for(t=0;t<e.length;t++){const s=e[t];s.user?e[r++]=s:H(s)}x.context&&P();const n=e.length;for(t=0;t<r;t++)H(e[t]);for(t=n;t<e.length;t++)H(e[t])}function z(e,t){const r=M;e.state=0;for(let n=0;n<e.sources.length;n+=1){const s=e.sources[n];s.sources&&(s.state===I||r?s!==t&&H(s):(s.state===K||r)&&z(s,t))}}function oe(e){const t=M;for(let r=0;r<e.observers.length;r+=1){const n=e.observers[r];(!n.state||t)&&(n.state=K,n.pure?w.push(n):A.push(n),n.observers&&oe(n))}}function ee(e){let t;if(e.sources)for(;e.sources.length;){const r=e.sources.pop(),n=e.sourceSlots.pop(),s=r.observers;if(s&&s.length){const l=s.pop(),o=r.observerSlots.pop();n<s.length&&(l.sourceSlots[o]=n,s[n]=l,r.observerSlots[n]=o)}}if(e.owned){for(t=0;t<e.owned.length;t++)ee(e.owned[t]);e.owned=null}if(e.cleanups){for(t=0;t<e.cleanups.length;t++)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function ce(e){throw e}function Q(e,t){return e?e.context&&e.context[t]!==void 0?e.context[t]:Q(e.owner,t):void 0}function X(e){if(typeof e=="function"&&!e.length)return X(e());if(Array.isArray(e)){const t=[];for(let r=0;r<e.length;r++){const n=X(e[r]);Array.isArray(n)?t.push.apply(t,n):t.push(n)}return t}return e}function Se(e){return function(r){let n;return W(()=>n=O(()=>(a.context={[e]:r.value},we(()=>r.children)))),n}}const ke=Symbol("fallback");function te(e){for(let t=0;t<e.length;t++)e[t]()}function Ce(e,t,r={}){let n=[],s=[],l=[],o=0,i=t.length>1?[]:null;return se(()=>te(l)),()=>{let d=e()||[],p,u;return d[ae],O(()=>{let c=d.length,g,b,m,F,S,h,y,k,T;if(c===0)o!==0&&(te(l),l=[],n=[],s=[],o=0,i&&(i=[])),r.fallback&&(n=[ke],s[0]=$(v=>(l[0]=v,r.fallback())),o=1);else if(o===0){for(s=new Array(c),u=0;u<c;u++)n[u]=d[u],s[u]=$(E);o=c}else{for(m=new Array(c),F=new Array(c),i&&(S=new Array(c)),h=0,y=Math.min(o,c);h<y&&n[h]===d[h];h++);for(y=o-1,k=c-1;y>=h&&k>=h&&n[y]===d[k];y--,k--)m[k]=s[y],F[k]=l[y],i&&(S[k]=i[y]);for(g=new Map,b=new Array(k+1),u=k;u>=h;u--)T=d[u],p=g.get(T),b[u]=p===void 0?-1:p,g.set(T,u);for(p=h;p<=y;p++)T=n[p],u=g.get(T),u!==void 0&&u!==-1?(m[u]=s[p],F[u]=l[p],i&&(S[u]=i[p]),u=b[u],g.set(T,u)):l[p]();for(u=h;u<c;u++)u in m?(s[u]=m[u],l[u]=F[u],i&&(i[u]=S[u],i[u](u))):s[u]=$(E);s=s.slice(0,o=c),n=d.slice(0)}return s});function E(c){if(l[u]=c,i){const[g,b]=j(u);return i[u]=b,t(d[u],g)}return t(d[u])}}}function Ae(e,t){return O(()=>e(t||{}))}function Le(e){let t,r;const n=s=>{const l=x.context;if(l){const[i,d]=j();(r||(r=e())).then(p=>{P(l),d(()=>p.default),P()}),t=i}else if(t){const i=t();if(i)return i(s)}else{const[i]=pe(()=>(r||(r=e())).then(d=>d.default));t=i}let o;return N(()=>(o=t())&&O(()=>{if(!l)return o(s);const i=x.context;P(l);const d=o(s);return P(i),d}))};return n.preload=()=>r||((r=e()).then(s=>t=()=>s.default),r),n}function Ne(e){const t="fallback"in e&&{fallback:()=>e.fallback};return N(Ce(()=>e.each,e.children,t||void 0))}function Pe(e){let t=!1;const r=N(()=>e.when,void 0,{equals:(n,s)=>t?n===s:!n==!s});return N(()=>{const n=r();if(n){const s=e.children;return(t=typeof s=="function"&&s.length>0)?O(()=>s(n)):s}return e.fallback})}const Ee=le();function Oe(e){let t=0,r,n,s,l,o,i;const[d,p]=j(!1),u=me(),E={increment:()=>{++t===1&&p(!0)},decrement:()=>{--t===0&&p(!1)},inFallback:d,effects:[],resolved:!1},c=he();if(x.context&&x.load){const m=x.context.id+x.context.count;if(l=x.load(m),l){(typeof l!="object"||!("then"in l))&&(l=Promise.resolve(l));const[F,S]=j(void 0,{equals:!1});o=F,l.then(h=>{if((i=h)||x.done)return S();x.gather(m),P(s),S(),P()})}}const g=be(Ee);g&&([r,n]=g.register(E.inFallback));let b;return se(()=>b&&b()),Ae(u.Provider,{value:E,get children(){return N(()=>{if(i)throw i;if(s=x.context,o)return o(),o=void 0;s&&l===void 0&&P();const m=N(()=>e.children);return N(()=>{const F=E.inFallback(),S=r?r():!0,h=n?n():!0;if(b&&b(),(!F||l!==void 0)&&S)return E.resolved=!0,s=l=void 0,ge(E.effects),m();if(!!h)return $(y=>(b=y,s&&(P({id:s.id+"f",count:0}),s=void 0),e.fallback),c)})})}})}export{Ne as F,Pe as S,Fe as a,N as b,$ as c,j as d,Ae as e,le as f,de as g,se as h,Oe as i,Le as l,Te as o,x as s,be as u};
